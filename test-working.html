<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Chemistry Research Group | NIT Bhopal</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #1e293b;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        header {
            background: #1a2332;
            color: white;
            padding: 20px 0;
        }
        header h1 { font-size: 1.8em; }
        nav ul { list-style: none; display: flex; gap: 20px; margin-top: 10px; }
        nav a { color: white; text-decoration: none; }
        .hero {
            background: linear-gradient(135deg, #1a2332 0%, #3b82f6 100%);
            color: white;
            padding: 100px 0;
            text-align: center;
        }
        .hero h2 { font-size: 3em; margin-bottom: 20px; }
        main { padding: 80px 0; }
        section { margin-bottom: 80px; }
        h2 { font-size: 2.5em; margin-bottom: 30px; color: #1a2332; }
        .card {
            background: white;
            padding: 30px;
            margin: 20px 0;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        footer {
            background: #1a2332;
            color: white;
            padding: 40px 0;
            text-align: center;
            margin-top: 80px;
        }
        .status {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="status" id="loadingStatus">🔄 Loading data from database...</div>

    <header>
        <div class="container">
            <h1>Green Chemistry Research Group</h1>
            <p>Department of Chemistry | NIT Bhopal</p>
            <nav>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#research">Research</a></li>
                    <li><a href="#people">People</a></li>
                    <li><a href="#publications">Publications</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="hero">
        <div class="container">
            <h2>Advancing Sustainable Chemistry</h2>
            <p>Pioneering research in green chemistry and organocatalysis</p>
        </div>
    </div>

    <main>
        <div class="container">
            <section id="research-section">
                <h2>🔬 Research Areas</h2>
                <div id="researchGrid" class="grid"></div>
            </section>

            <section id="publications-section">
                <h2>📚 Publications</h2>
                <div id="publicationsList"></div>
            </section>

            <section id="people-section">
                <h2>👥 Our Team</h2>
                <div id="peopleGrid" class="grid"></div>
            </section>

            <section id="news-section">
                <h2>📰 Latest News</h2>
                <div id="newsList"></div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Green Chemistry Research Group, NIT Bhopal</p>
        </div>
    </footer>

    <script>
        console.log('Script loading started...');
        
        // API Configuration
        const API_BASE_URL = 'http://localhost:5000/api';
        
        console.log('API_BASE_URL:', API_BASE_URL);

        // API Helper
        const API = {
            async request(endpoint) {
                try {
                    console.log('Fetching:', API_BASE_URL + endpoint);
                    const response = await fetch(API_BASE_URL + endpoint);
                    const data = await response.json();
                    console.log('Received:', endpoint, data);
                    return data;
                } catch (error) {
                    console.error('API Error:', error);
                    throw error;
                }
            },

            getPublications() { return this.request('/publications'); },
            getPeople() { return this.request('/people'); },
            getNews() { return this.request('/news'); },
            getResearchAreas() { return this.request('/research-areas'); }
        };

        console.log('API object created:', API);

        // Load Research Areas
        async function loadResearch() {
            const grid = document.getElementById('researchGrid');
            try {
                const areas = await API.getResearchAreas();
                grid.innerHTML = areas.map(area => `
                    <div class="card">
                        <h3>${area.title}</h3>
                        <p>${area.description}</p>
                    </div>
                `).join('');
            } catch (error) {
                grid.innerHTML = '<p>Error loading research areas</p>';
            }
        }

        // Load Publications
        async function loadPublications() {
            const list = document.getElementById('publicationsList');
            try {
                const pubs = await API.getPublications();
                list.innerHTML = pubs.map(pub => `
                    <div class="card">
                        <strong>${pub.authors}</strong><br>
                        <em>"${pub.title}"</em><br>
                        ${pub.journal} (${pub.year})
                    </div>
                `).join('');
            } catch (error) {
                list.innerHTML = '<p>Error loading publications</p>';
            }
        }

        // Load People
        async function loadPeople() {
            const grid = document.getElementById('peopleGrid');
            try {
                const people = await API.getPeople();
                grid.innerHTML = people.map(person => `
                    <div class="card">
                        <h3>${person.name}</h3>
                        <p><strong>${person.role}</strong></p>
                        <p>📧 ${person.email}</p>
                        <p><small>Category: ${person.category}</small></p>
                    </div>
                `).join('');
            } catch (error) {
                grid.innerHTML = '<p>Error loading people</p>';
            }
        }

        // Load News
        async function loadNews() {
            const list = document.getElementById('newsList');
            try {
                const news = await API.getNews();
                list.innerHTML = news.map(item => `
                    <div class="card">
                        <h3>${item.headline}</h3>
                        <p><strong>${new Date(item.date).toLocaleDateString()}</strong> | ${item.tag}</p>
                        <p>${item.content}</p>
                    </div>
                `).join('');
            } catch (error) {
                list.innerHTML = '<p>Error loading news</p>';
            }
        }

        // Load All Data
        async function loadAllData() {
            console.log('Loading all data...');
            const status = document.getElementById('loadingStatus');
            
            try {
                await Promise.all([
                    loadResearch(),
                    loadPublications(),
                    loadPeople(),
                    loadNews()
                ]);
                
                status.style.background = '#d1fae5';
                status.style.borderColor = '#10b981';
                status.innerHTML = '✅ Data loaded successfully from database!';
                
                setTimeout(() => status.style.display = 'none', 3000);
                
                console.log('All data loaded successfully!');
            } catch (error) {
                status.style.background = '#fee2e2';
                status.style.borderColor = '#ef4444';
                status.innerHTML = '❌ Error loading data. Make sure server is running!';
                console.error('Load error:', error);
            }
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, starting data load...');
            loadAllData();
        });

        console.log('Script loaded successfully!');
        console.log('Check: typeof API =', typeof API);
    </script>
</body>
</html>